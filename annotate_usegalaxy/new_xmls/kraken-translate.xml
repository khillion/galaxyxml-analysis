<tool id="kraken-translate" name="Kraken-translate" version="1.2.1">
  <!--This tool descriptor has been annotated by ToolDog v0.3.0-->
  <description>
        convert taxonomy IDs to names
    </description>
  <edam_operations>
    <edam_operation>operation_3460</edam_operation>
  </edam_operations>
  <edam_topics>
    <edam_topic>topic_0091</edam_topic>
  </edam_topics>
  <stdio>
    <exit_code level="fatal" range="1:"/>
  </stdio>
  <version_command/>
  <command><![CDATA[
        
        @SET_DATABASE_PATH@ &&
        kraken-translate @INPUT_DATABASE@ $mpa_format "${input}" > "${translated}"
        
    ]]></command>
  <inputs>
    <param argument="input" format="tabular" help="Select taxonomy classification produced by kraken" label="Kraken output" name="input" type="data"/>
    <param argument="mpa_format" checked="false" falsevalue="" label="Restrict labels to standard rank assignments" name="mpa_format" truevalue="--mpa-format" type="boolean"/>
  </inputs>
  <outputs>
    <data format="tabular" hidden="false" label="${tool.name} on ${on_string}: Translated classification" name="translated"/>
  </outputs>
  <tests>
    <test>
      <param ftype="tabular" name="input" value="kraken_translate_test1.tab"/>
      <param name="mpa-format" value="false"/>
      <param name="kraken_database" value="test_db"/>
      <output file="kraken_translate_test1_output.tab" ftype="tabular" name="translated"/>
    </test>
  </tests>
  <help><![CDATA[
        

.. class:: warningmark

**Note**: the database used must be the same as the one used in the original Kraken run

-------

**What it does**

The file sequences.labels generated by the above example is a text file with two tab-delimited columns, and one line for each classified sequence in sequences.fa; unclassified sequences are not reported by kraken-translate. The first column of kraken-translate's output are the sequence IDs of the classified sequences, and the second column contains the taxonomy of the sequence. For example, an output line from kraken::

 C     SEQ1    562     36      562:6

Would result in a corresponding output line from kraken-translate::

 SEQ1  root;cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacteriales;Enterobacteriaceae;Escherichia;Escherichia coli

Alternatively, kraken-translate accepts the option ``--mpa-format`` which will report only levels of the taxonomy with standard rank assignments (superkingdom, kingdom, phylum, class, order, family, genus, species), and uses pipes to delimit the various levels of the taxonomy. For example, ``kraken-translate --mpa-format`` with the above example output from kraken would result in the following line of output::

 SEQ1  d__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Enterobacteriales|f__Enterobacteriaceae|g__Escherichia|s__Escherichia_coli

Taxonomy assignments above the superkingdom rank are represented as just "root" when using the ``--mpa-report`` option with kraken-translate.
        
    ]]></help>
  <citations>
    <citation type="doi">10.1186/gb-2014-15-3-r46</citation>
  </citations>
</tool>
